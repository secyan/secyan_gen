(this.webpackJsonpwebapp=this.webpackJsonpwebapp||[]).push([[2],{466:function(e,t,n){},842:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),c=n(66),o=n.n(c),r=(n(466),n(18)),s=n(379),l=n(130),u=n(893),d=n(901),b=n(330),j=n(911),h=n(912),f=(n(571),n(451)),m=n(908),p=n(909),g=n(910),O=n(13),x=n.n(O),v=n(194),C=n(534),y=n(538),k=n(304),w=n.n(k),S="/schema",R="/download_data",_="/generate_python",I="code",T="role",E="datadir",N="backend",D="tableStructure",L=n(7),A=n(1),P=n(2),J=[{keyword:"select",desc:""},{keyword:"from",desc:""},{keyword:"where",desc:""},{keyword:"sum",desc:"Aggregation function"},{keyword:"max",desc:"Aggregation function"},{keyword:"avg",desc:"Aggregation function"},{keyword:"count",desc:"Aggregation function"},{keyword:"group by",desc:""},{keyword:"desc",desc:""},{keyword:"limit",desc:""},{keyword:"having",desc:""},{keyword:"exists",desc:""}],K=function(){function e(){Object(A.a)(this,e)}return Object(P.a)(e,null,[{key:"getURL",value:function(e){return new URL(e,Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_URL).href}},{key:"generateHover",value:function(e,t,n,a){if(!a)return{range:e,contents:[]};var i,c=Object(L.a)(J);try{for(c.s();!(i=c.n()).done;){var o=i.value;if(n.toLowerCase().includes(o.keyword.toLowerCase()))return{range:e,contents:[{value:"SQL Built In"},{value:o.desc}]}}}catch(j){c.e(j)}finally{c.f()}var r,s=Object(L.a)(a);try{for(s.s();!(r=s.n()).done;){var l=r.value;if(n.toLowerCase().includes(l.table_name.toLowerCase()))return{range:e,contents:[{value:"Table Name"}]};var u,d=Object(L.a)(l.columns);try{for(d.s();!(u=d.n()).done;){var b=u.value;if(n.toLocaleLowerCase().includes(b.name.toLowerCase()))return{range:e,contents:[{value:l.table_name},{value:"**Type: ".concat(b.column_type,"**")}]}}}catch(j){d.e(j)}finally{d.f()}}}catch(j){s.e(j)}finally{s.f()}}}]),e}(),B=n(30),q=i.a.createContext({});function z(e){var t=e.children,n=i.a.useState([]),a=Object(r.a)(n,2),c=a[0],o=a[1],s=i.a.useState(!1),l=Object(r.a)(s,2),u=l[0],d=l[1];i.a.useEffect((function(){var e=localStorage.getItem(D);null!==e&&o(JSON.parse(e))}),[]),i.a.useEffect((function(){localStorage.setItem(D,JSON.stringify(c))}),[c]);var b=i.a.useCallback((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];localStorage.setItem(D,JSON.stringify(e)),t&&o(JSON.parse(JSON.stringify(e)))}),[c]),j=i.a.useCallback(Object(v.a)(x.a.mark((function e(){var t,n,a,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=K.getURL(S),e.next=4,w.a.get(t);case 4:n=e.sent,b(n.data),C.b.success("Tables are updated"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),y.a.error({message:"Cannot fetch table configs",description:"".concat(null!==(a=null===e.t0||void 0===e.t0||null===(i=e.t0.response)||void 0===i?void 0:i.data)&&void 0!==a?a:"Cannot connect to the backend"),duration:5,placement:"bottomRight"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),[]),h={configs:c,setConfigs:b,setOpenRawConfigDialog:d,openRawConfigDialog:u,fetchConfigs:j};return Object(B.jsx)(q.Provider,{value:h,children:t})}var U=n(415),F=n(895),M=n(220),Y=n(897),H=n(898),V={$schema:"http://json-schema.org/draft-06/schema#",type:"array",items:{$ref:"#/definitions/TableConfigElement"},definitions:{TableConfigElement:{type:"object",additionalProperties:!1,properties:{data_sizes:{type:"array",items:{type:"integer"}},data_paths:{type:"array",items:{type:"string"}},annotations:{type:"array",items:{type:"string"}},table_name:{type:"string"},owner:{type:"string"},columns:{type:"array",items:{$ref:"#/definitions/Column"}}},required:["columns","data_sizes","table_name","data_paths","annotations"],title:"TableConfigElement"},Column:{type:"object",additionalProperties:!1,properties:{column_type:{type:"string"},name:{type:"string"}},required:["column_type","name"],title:"Column"}}};function G(){var e=i.a.useContext(q),t=e.setOpenRawConfigDialog,n=e.openRawConfigDialog,a=e.configs,c=e.setConfigs,o=i.a.useState(""),s=Object(r.a)(o,2),l=s[0],u=s[1],d=i.a.useCallback((function(){u(JSON.stringify(a,null,4)),t(!0)}),[a]),b=i.a.useCallback((function(){c(JSON.parse(l)),t(!1)}),[l]),j=i.a.useCallback((function(e){e.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,enableSchemaRequest:!0,schemas:[{uri:"https://raw.githubusercontent.com/sirily11/SECYAN-GEN/master/examples/table_config.json",fileMatch:["*"],schema:V}]})}),[l]);return Object(B.jsxs)(F.a,{title:"Table Configuration",subTitle:"Config your table's info here",extra:[Object(B.jsx)(M.a,{type:"primary",onClick:d,children:"Set Raw Data"})],children:[Object(B.jsxs)(Y.a,{style:{maxWidth:"800px"},children:["You can either use the raw Data Config Editor to modify your database table's infomation, or use the GUI below to modify your table. You can check this"," ",Object(B.jsx)(Y.a.Link,{target:"_blank",href:"https://github.com/sirily11/SECYAN-GEN/blob/master/examples/table_config.json",children:"Link"})," ","for example table configuration. You can also fetch table schema by clicking the fetching button. The data path and size field might be empty and will be updated when you click fetch data in settings page. You can update the field mannuly by using raw data editor, however, we don't recommand editting this field mannully."]}),Object(B.jsx)(H.a,{title:"Raw Data Configuration",visible:n,onOk:b,onCancel:b,footer:[Object(B.jsx)(M.a,{onClick:b,children:"Close"})],width:.8*window.innerWidth,children:Object(B.jsx)(U.a,{height:500,language:"json",options:{minimap:{enabled:!1}},beforeMount:function(e){return j(e)},value:l,onChange:function(e){u(null!==e&&void 0!==e?e:"")}})})]})}var W=n(453),$=n(170),Q=n(900),X=n(894),Z=n(225),ee=n(355),te=n(899),ne=n(902),ae=n(540),ie=n(903),ce=n(541),oe=["int","string","decimal","date"],re=["CLIENT","SERVER"],se=n(486),le=["key","name","fieldKey"],ue=["key","name","fieldKey"];function de(e){var t,n=e.config,a=e.index,c=i.a.useState(n.table_name),o=Object(r.a)(c,2),s=o[0],l=o[1],u=i.a.useState(n.owner),j=Object(r.a)(u,2),h=j[0],f=j[1],m=i.a.useState(!1),p=Object(r.a)(m,2),g=p[0],O=p[1],x=i.a.useContext(q),v=x.setConfigs,C=x.configs,k=i.a.useCallback((function(){return Object($.a)(Object($.a)({},n),{},{annotations:n.annotations.map((function(e){return{annotation:e}}))})}),[n]),w=i.a.useCallback((function(){C[a].table_name=s,C[a].owner=h,v(C),O(!1)}),[s,h]),S=i.a.useCallback((function(e){console.log(e.annotations);var t=e.annotations.filter((function(e){return void 0!==e&&void 0!==e.annotation})).map((function(e){return e.annotation}));C[a].columns=e.columns,C[a].annotations=void 0!==t?t:[],v(C,!1)}),[n,C]),R=i.a.useCallback((function(){H.a.confirm({title:"confirm",content:"Delete this table",onOk:function(){C.splice(a,1),v(JSON.parse(JSON.stringify(C))),y.a.success({message:"Table deleted",placement:"bottomRight"})}})}),[n]);return Object(B.jsxs)(d.a,{id:n.table_name,title:"".concat(n.table_name," - ").concat(null!==(t=n.owner)&&void 0!==t?t:"Client"),style:{margin:10},extra:[Object(B.jsx)(M.a,{shape:"circle",onClick:R,style:{marginRight:10},children:Object(B.jsx)(ne.a,{})}),Object(B.jsx)(M.a,{shape:"circle",onClick:function(){return O(!0)},children:Object(B.jsx)(ae.a,{})})],children:[Object(B.jsxs)(Q.b,{title:"Data size and path",bordered:!0,children:[Object(B.jsx)(Q.b.Item,{label:"Data Path",children:Object(B.jsx)("div",{"data-testid":"table-config-path",children:n.data_paths})}),Object(B.jsx)(Q.b.Item,{label:"Data Size",children:Object(B.jsx)("div",{"data-testid":"table-config-size",children:n.data_sizes})})]}),Object(B.jsxs)(X.a,{style:{marginTop:20},initialValues:k(),onValuesChange:function(e,t){S(t)},children:[Object(B.jsx)(Y.a.Title,{level:5,children:"Table Columns"}),Object(B.jsx)(X.a.List,{name:"columns",children:function(e,t){var n=t.add,a=t.remove;return Object(B.jsxs)(b.a,{gutter:[10,10],children:[null===e||void 0===e?void 0:e.map((function(e){var t=e.key,n=e.name,i=e.fieldKey,c=Object(W.a)(e,le);return Object(B.jsx)(Z.a,{style:{display:"flex",marginBottom:8},xs:24,children:Object(B.jsxs)(b.a,{style:{width:"100%"},gutter:[20,10],children:[Object(B.jsx)(Z.a,{md:5,xs:24,children:Object(B.jsx)(X.a.Item,Object($.a)(Object($.a)({},c),{},{name:[n,"column_type"],fieldKey:[i,"type"],rules:[{required:!0,message:"Column type is required"}],children:Object(B.jsx)(ee.a,{children:oe.map((function(e,t){return Object(B.jsx)(ee.a.Option,{value:e,children:e})}))})}))}),Object(B.jsx)(Z.a,{md:5,xs:22,children:Object(B.jsx)(X.a.Item,Object($.a)(Object($.a)({},c),{},{name:[n,"name"],fieldKey:[i,"name"],rules:[{required:!0,message:"Column name is required"}],children:Object(B.jsx)(te.a,{placeholder:"Column Name"})}))}),Object(B.jsx)(Z.a,{span:2,children:Object(B.jsx)(ie.a,{onClick:function(){return a(n)}})})]})},"column-".concat(t))})),Object(B.jsx)(Z.a,{xs:24,children:Object(B.jsx)(X.a.Item,{children:Object(B.jsx)(M.a,{type:"dashed",onClick:function(){return n()},block:!0,icon:Object(B.jsx)(ce.a,{}),children:"Add Column"})})},"button-".concat(Object(se.a)()))]})}}),Object(B.jsx)(Y.a.Title,{level:5,children:"Annotations"}),Object(B.jsx)(X.a.List,{name:"annotations",children:function(e,t){var n=t.add,a=t.remove;return Object(B.jsxs)("div",{children:[null===e||void 0===e?void 0:e.map((function(e){e.key;var t=e.name,n=e.fieldKey;Object(W.a)(e,ue);return Object(B.jsxs)(b.a,{gutter:[10,10],children:[Object(B.jsx)(Z.a,{span:22,children:Object(B.jsx)(X.a.Item,{name:[t,"annotation"],fieldKey:[n,"annotation"],label:"Annotation",children:Object(B.jsx)(te.a,{})})}),Object(B.jsx)(Z.a,{children:Object(B.jsx)(ie.a,{onClick:function(){return a(t)}})})]})})),Object(B.jsx)(X.a.Item,{children:Object(B.jsx)(M.a,{type:"dashed",onClick:function(){return n()},block:!0,icon:Object(B.jsx)(ce.a,{}),children:"Add Annotation"})})]})}})]}),Object(B.jsxs)(H.a,{visible:g,title:"Table name",onCancel:function(){l(n.table_name),f(n.owner),O(!1)},onOk:w,children:[Object(B.jsx)(te.a,{placeholder:"Table name",value:s,onChange:function(e){l(e.target.value)}}),Object(B.jsx)(ee.a,{style:{width:"100%",marginTop:20},placeholder:"Select Owner",value:h,onChange:function(e){return f(e)},children:re.map((function(e){return Object(B.jsx)(ee.a.Option,{value:e,children:e},e)}))})]})]},a)}var be=n(400),je=n.n(be);function he(){var e=i.a.useContext(q),t=e.configs,n=(e.setConfigs,i.a.useState(!1)),a=Object(r.a)(n,2),c=(a[0],a[1],i.a.useState(!0)),o=Object(r.a)(c,2),s=o[0],u=o[1],d=Object(l.g)(),b=je.a.parse(d.search);return i.a.useEffect((function(){setTimeout((function(){u(!1)}),50)}),[]),i.a.useEffect((function(){var e=b.table;if(e){var t=document.getElementById(e);null===t||void 0===t||t.scrollIntoView()}}),[d.search,s]),Object(B.jsxs)("div",{style:{overflowY:"scroll",height:"100%"},children:[Object(B.jsx)(G,{}),!s&&(null===t||void 0===t?void 0:t.map((function(e,t){return Object(B.jsx)(de,{config:e,index:t},"config-".concat(t))})))]})}var fe=n(450),me=i.a.createContext({});function pe(e){var t=e.children,n=i.a.useState([]),a=Object(r.a)(n,2),c=a[0],o=a[1],s=i.a.useState(!1),l=Object(r.a)(s,2),u=l[0],d=l[1],b=i.a.useState(0),j=Object(r.a)(b,2),h=j[0],f=j[1],m=i.a.useState(!1),p=Object(r.a)(m,2),g=p[0],O=p[1];i.a.useEffect((function(){var e=localStorage.getItem(I);if(e)try{o(JSON.parse(e))}catch(t){console.log("No Code Saved")}}),[]);var C=i.a.useCallback((function(e){localStorage.setItem(I,JSON.stringify(e)),o(JSON.parse(JSON.stringify(e)))}),[c]),k=i.a.useCallback(function(){var e=Object(v.a)(x.a.mark((function e(t,n){var a,i,o,r,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K.getURL(_),i=c[t],e.prev=2,d(!0),e.next=6,w.a.post(a,{sql:i.code,annotation_name:i.annotation_name,num_of_rows:i.num_of_rows,table:JSON.stringify(n)});case 6:o=e.sent,c[t].result=o.data,C(c),y.a.info({message:"Code results returned",placement:"bottomRight"}),d(!1),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),d(!1),y.a.error({message:"Cannot generate code",description:"".concat(null!==(r=null===e.t0||void 0===e.t0||null===(s=e.t0.response)||void 0===s?void 0:s.data)&&void 0!==r?r:"Cannot connect to the backend"),duration:5,placement:"bottomRight"});case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t,n){return e.apply(this,arguments)}}(),[c]),S=i.a.useCallback((function(){c.forEach((function(e){e.result=void 0})),C(c)}),[c]),R={codeRunResults:c,setCodeRunResults:C,runCode:k,isLoading:u,index:h,setIndex:f,showEdit:g,setShowEdit:O,deleteResultCache:S};return Object(B.jsx)(me.Provider,{value:R,children:t})}var ge=i.a.createContext({});function Oe(e){var t=i.a.useState(!1),n=Object(r.a)(t,2),a=n[0],c=n[1],o=i.a.useState("Server"),s=Object(r.a)(o,2),l=s[0],u=s[1],d=i.a.useState("Default Backend"),b=Object(r.a)(d,2),j=b[0],h=b[1],f=i.a.useState(""),m=Object(r.a)(f,2),p=m[0],g=m[1],O=i.a.useState(!1),k=Object(r.a)(O,2),S=k[0],_=k[1];i.a.useEffect((function(){var e=localStorage.getItem(T),t=localStorage.getItem(N),n=localStorage.getItem(E);e&&u(e),t&&h(t),n&&g(n),c(!0)}),[]);var I=i.a.useCallback((function(e){localStorage.setItem(E,e),g(e)}),[]),D=i.a.useCallback((function(e){localStorage.setItem(T,e),u(e)}),[]),L=i.a.useCallback((function(e){localStorage.setItem(N,e),h(e)}),[]),A=i.a.useCallback(function(){var e=Object(v.a)(x.a.mark((function e(t){var n,a,i,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(!0),e.prev=1,n=K.getURL(R),e.next=5,w.a.post(n,{tables:JSON.stringify(t),output_dir:p});case 5:return a=e.sent,C.b.success("Successfully dump data into "+p,8),e.abrupt("return",a.data);case 10:return e.prev=10,e.t0=e.catch(1),y.a.error({message:"Cannot fetch table configs",description:"".concat(null!==(i=null===e.t0||void 0===e.t0||null===(c=e.t0.response)||void 0===c?void 0:c.data)&&void 0!==i?i:"Cannot connect to the backend"),duration:5,placement:"bottomRight"}),e.abrupt("return",void 0);case 14:return e.prev=14,_(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,10,14,17]])})));return function(t){return e.apply(this,arguments)}}(),[p]),P={role:l,setRole:D,backend:j,setBackend:L,datadir:p,setDatadir:I,loaded:a,isDownloading:S,downloadData:A};return Object(B.jsx)(ge.Provider,{value:P,children:e.children})}var xe=n(526),ve=n(292),Ce=function(){function e(){Object(A.a)(this,e)}return Object(P.a)(e,null,[{key:"generateSuggestions",value:function(e,t){if(t){var n,a=[],i=Object(L.a)(t);try{for(i.s();!(n=i.n()).done;){var c=n.value;a.push({label:c.table_name,kind:ve.a.CompletionItemKind.Constant,documentation:"",insertText:c.table_name.toUpperCase(),insertTextRules:ve.a.CompletionItemInsertTextRule.InsertAsSnippet,range:e});var o,r=Object(L.a)(c.columns);try{for(r.s();!(o=r.n()).done;){var s=o.value;a.push({label:s.name,kind:ve.a.CompletionItemKind.Constant,documentation:"".concat(s.column_type),insertText:s.name,insertTextRules:ve.a.CompletionItemInsertTextRule.InsertAsSnippet,range:e})}}catch(b){r.e(b)}finally{r.f()}}}catch(b){i.e(b)}finally{i.f()}var l,u=Object(L.a)(J);try{for(u.s();!(l=u.n()).done;){var d=l.value;a.push({label:d.keyword,kind:ve.a.CompletionItemKind.Keyword,document:d.desc,insertText:d.keyword.toUpperCase(),insertTextRules:ve.a.CompletionItemInsertTextRule.InsertAsSnippet,range:e})}}catch(b){u.e(b)}finally{u.f()}return a}return[]}}]),e}(),ye=void 0,ke=void 0;function we(e){var t=e.codeRunResult,n=e.index,a=i.a.useContext(me),c=a.setCodeRunResults,o=a.codeRunResults,s=(a.showEdit,a.setShowEdit,i.a.useState(!0)),l=Object(r.a)(s,2),u=l[0],d=l[1],j=i.a.useContext(q).configs,h=i.a.useContext(ge).role,f=i.a.useState(),m=Object(r.a)(f,2),p=m[0],g=m[1],O=i.a.useCallback((function(e){var t,n;null===(t=ye)||void 0===t||t.dispose(),null===(n=ke)||void 0===n||n.dispose(),ke=e.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(e,t){var n=e.getWordUntilPosition(t),a={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:n.startColumn,endColumn:n.endColumn};if(j)return{suggestions:Ce.generateSuggestions(a,j)}}}),ye=e.languages.registerHoverProvider("sql",{provideHover:function(e,t){var n,a=e.getWordAtPosition(t),i={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:null===a||void 0===a?void 0:a.startColumn,endColumn:null===a||void 0===a?void 0:a.endColumn};return K.generateHover(i,e,null!==(n=null===a||void 0===a?void 0:a.word)&&void 0!==n?n:"",j)}})}),[j,p]);i.a.useEffect((function(){y.a.info({message:"Loading Data",placement:"bottomRight"})}),[]);var x=i.a.useCallback((function(e){o[n].code=e,c(o)}),[t]);return Object(B.jsx)("div",{style:{padding:10},children:Object(B.jsxs)(b.a,{gutter:[10,10],children:[Object(B.jsx)(Z.a,{xs:8,children:Object(B.jsx)(U.a,{value:t.code,onMount:function(e){g(e),d(!1),y.a.close("Data Loaded")},language:"sql",beforeMount:function(e){return O(e)},options:{minimap:{enabled:!1}},height:"calc(100vh - 64px - 56px - 20px)",onChange:function(e){x(e)}})}),Object(B.jsx)(Z.a,{xs:16,style:{overflowY:"scroll",overflowX:"scroll",height:"100%"},children:Object(B.jsx)("div",{style:{height:"calc(100vh - 64px - 56px - 30px)",overflowY:"hidden"},children:t.result&&!u&&Object(B.jsx)(xe.a,{columns:function(){var e,n,a,i="Server"===h?null===(e=t.result)||void 0===e?void 0:e.server_result:null===(n=t.result)||void 0===n?void 0:n.client_result;return null!==(a=null===i||void 0===i?void 0:i.length)&&void 0!==a&&a?i[0].map((function(e){return{title:e.toLocaleUpperCase(),field:e.toLowerCase(),width:20*e.length}})):[]}(),rows:function(){var e,n,a=[],i="Server"===h?null===(e=t.result)||void 0===e?void 0:e.server_result:null===(n=t.result)||void 0===n?void 0:n.client_result;if(i){var c=i[0];i.slice(1).forEach((function(e,t){var n={id:t};e.forEach((function(e,t){n[c[t]]=e})),a.push(n)}))}return a}(),rowHeight:60})})})]})})}function Se(){var e=i.a.useContext(me),t=e.codeRunResults,n=e.setCodeRunResults,a=e.setIndex,c=(i.a.useContext(q).configs,i.a.useCallback((function(){return t.map((function(e,t){return Object(B.jsx)(fe.a.TabPane,{tab:e.name,style:{height:"100%"},children:Object(B.jsx)(we,{codeRunResult:e,index:t})},t)}))}),[t]));return Object(B.jsx)(fe.a,{type:"editable-card",style:{height:"100%"},addIcon:Object(B.jsx)(ce.a,{}),onChange:function(e){a(parseInt(e))},onEdit:function(e,a){"add"===a?(t.push({name:"newResult",code:"",num_of_rows:100,annotation_name:"q3_annot"}),n(t)):(t.splice(parseInt(e),1),n(t))},children:c()})}var Re=n(238),_e=n(539),Ie=n(904),Te=n(905),Ee=n(906),Ne=n(378),De=n.n(Ne),Le=n(528),Ae=n.n(Le);function Pe(){var e,t=i.a.useContext(me),n=null===(e=t.codeRunResults[t.index])||void 0===e?void 0:e.result;return Object(B.jsx)("div",{style:{height:500,width:1e3},children:n&&Object(B.jsx)(Ae.a,{data:n.joinGraph,orientation:"vertical",pathFunc:"step",translate:{y:100,x:400},nodeSize:{x:257,y:175}})})}function Je(){var e,t=i.a.useContext(me),n=t.setCodeRunResults,a=t.codeRunResults,c=t.runCode,o=t.isLoading,s=t.index,l=t.setShowEdit,u=t.showEdit,d=i.a.useContext(q).configs,j=i.a.useContext(ge),h=j.role,f=j.setRole,m=X.a.useForm(),p=Object(r.a)(m,1)[0],g=i.a.useCallback((function(){var e=p.getFieldsValue();a[s].annotation_name=e.annotation_name,a[s].name=e.name,a[s].num_of_rows=parseInt(e.num_of_rows),n(a),l(!1)}),[a,s]);return i.a.useEffect((function(){p.setFieldsValue(a[s])}),[u]),Object(B.jsxs)(b.a,{justify:"end",style:{marginRight:20},children:[Object(B.jsx)(Re.a,{title:"Run Code",children:Object(B.jsx)(M.a,{shape:"round",size:"large",style:{marginRight:10},loading:o,onClick:Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(s,d);case 2:case"end":return e.stop()}}),e)}))),children:Object(B.jsx)(Ie.a,{})})}),Object(B.jsx)(Re.a,{title:'"Current role: '.concat(h,'"'),children:Object(B.jsx)(M.a,{shape:"round",size:"large",style:{marginRight:10},onClick:Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f("Client"===h?"Server":"Client");case 1:case"end":return e.stop()}}),e)}))),children:Object(B.jsx)(Te.a,{})})}),Object(B.jsx)(Re.a,{title:"Rename",children:Object(B.jsx)(M.a,{shape:"round",size:"large",style:{marginRight:10},onClick:function(){l(!0)},children:Object(B.jsx)(ae.a,{})})}),(null===(e=a[s])||void 0===e?void 0:e.result)&&Object(B.jsx)(_e.a,{content:Object(B.jsx)(Pe,{}),placement:"leftBottom",trigger:"click",children:Object(B.jsx)(Re.a,{title:"Join Tree",children:Object(B.jsx)(M.a,{shape:"round",size:"large",style:{marginRight:10},onClick:function(){},children:Object(B.jsx)(Ee.a,{})})})}),Object(B.jsx)(De.a,{title:"Configuration",visible:u,onOk:g,onCancel:function(){p.resetFields(),l(!1)},children:Object(B.jsxs)(X.a,{initialValues:a[s],form:p,children:[Object(B.jsx)(X.a.Item,{name:"name",label:"Name",children:Object(B.jsx)(te.a,{placeholder:"Name"})}),Object(B.jsx)(X.a.Item,{name:"num_of_rows",label:"Number of rows",children:Object(B.jsx)(te.a,{placeholder:"Num of rows",type:"number"})}),Object(B.jsx)(X.a.Item,{name:"annotation_name",label:"Annotation Name",children:Object(B.jsx)(te.a,{placeholder:"Annotation Name"})})]})})]})}var Ke=n(896),Be=n(529);function qe(){var e=i.a.useContext(ge),t=e.role,n=e.setRole,a=e.backend,c=e.setBackend,o=e.datadir,r=e.setDatadir,s=e.loaded,l=e.downloadData,u=e.isDownloading,b=i.a.useContext(q),j=b.configs,h=b.setConfigs,f=i.a.useContext(me).deleteResultCache,m={role:t,backend:a,datadir:o},p=Object(B.jsxs)("div",{children:[Object(B.jsxs)(d.a,{children:[Object(B.jsx)(Y.a.Title,{level:5,children:"General Settings"}),Object(B.jsxs)(X.a,{initialValues:m,onValuesChange:function(e){e.role&&n(e.role),e.backend&&c(e.backend),e.datadir&&r(e.datadir)},children:[Object(B.jsx)(X.a.Item,{label:"Default data dir",name:"datadir",help:"Your table's data will be stored in this folder",children:Object(B.jsx)(te.a,{})}),Object(B.jsx)(X.a.Item,{label:"Role",name:"role",children:Object(B.jsx)(ee.a,{children:["Client","Server"].map((function(e,t){return Object(B.jsx)(ee.a.Option,{value:e,children:e},"role-".concat(t))}))})}),Object(B.jsx)(X.a.Item,{label:"Backend",name:"backend",extra:"This will only affect the c++ code generator",children:Object(B.jsx)(ee.a,{children:["Default Backend","Postgres Backend"].map((function(e,t){return Object(B.jsx)(ee.a.Option,{value:e,children:e},"role-".concat(t))}))})})]})]}),Object(B.jsx)(d.a,{title:"Data",style:{marginTop:10},children:Object(B.jsxs)(Ke.b,{children:[Object(B.jsxs)(Ke.b.Item,{children:[Object(B.jsx)(Ke.b.Item.Meta,{title:"Stored results",description:"Your query results"}),Object(B.jsx)(M.a,{onClick:function(){f(),C.b.success("Delete cache successfully")},children:"Delete"})]}),Object(B.jsxs)(Ke.b.Item,{children:[Object(B.jsx)(Ke.b.Item.Meta,{title:"Download Data",description:"Download table data from database"}),Object(B.jsx)(M.a,{loading:u,onClick:Object(v.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(j);case 2:(t=e.sent)&&h(t);case 4:case"end":return e.stop()}}),e)}))),children:"Download data"})]})]})})]});return Object(B.jsxs)("div",{style:{padding:10},children:[Object(B.jsx)(Y.a.Title,{level:3,children:"Settings"}),s?p:Object(B.jsx)(Be.a,{})]})}var ze=n(907);function Ue(){var e=i.a.useState(!1),t=Object(r.a)(e,2),n=t[0],a=t[1],c=i.a.useState(!1),o=Object(r.a)(c,2),s=o[0],l=o[1],u=i.a.useContext(q),d=u.configs,b=u.setConfigs,j=u.fetchConfigs,h=i.a.useCallback((function(){d.push({table_name:"table",data_sizes:[],data_paths:[],columns:[],owner:"Server",annotations:[]}),b(d),a(!1),y.a.success({message:"Added a new table",placement:"bottomRight"})}),[d]);return Object(B.jsxs)("div",{children:[Object(B.jsx)(Re.a,{title:"Fetch Table Config from DB",children:Object(B.jsx)(M.a,{shape:"round",loading:s,style:{marginRight:20},onClick:Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.next=3,j();case 3:l(!1);case 4:case"end":return e.stop()}}),e)}))),children:Object(B.jsx)(ze.a,{})})}),Object(B.jsx)(Re.a,{title:"Create a new table",children:Object(B.jsx)(M.a,{shape:"round",style:{marginRight:20},onClick:function(){return a(!0)},children:Object(B.jsx)(ce.a,{})})}),Object(B.jsx)(H.a,{visible:n,title:"Add New Table",onOk:h,onCancel:function(){a(!1)},children:Object(B.jsx)(Y.a,{children:"Create a empty table?"})})]})}var Fe=[{path:"/",title:"Table Config",component:Object(B.jsx)(he,{}),icon:Object(B.jsx)(m.a,{}),action:Object(B.jsx)(Ue,{}),hasSubMenu:!0},{path:"/settings",title:"Settings",component:Object(B.jsx)(qe,{}),icon:Object(B.jsx)(p.a,{}),hasSubMenu:!1},{path:"/editor",title:"Query Editor",component:Object(B.jsx)(Se,{}),icon:Object(B.jsx)(g.a,{}),hasSubMenu:!1,action:Object(B.jsx)(Je,{})}],Me=n(531),Ye=n.n(Me);function He(e){var t=i.a.useContext(q).configs,n=Object(l.g)(),a=Object(l.f)(),c=i.a.useState(Fe[0].title),o=Object(r.a)(c,2),s=o[0],u=o[1],d=(e.expanded,je.a.parse(n.search).table);i.a.useEffect((function(){if(n.pathname!==Fe[0].path){var e=Fe.find((function(e){return n.pathname.includes(e.path)&&e.path!==Fe[0].path}));e&&u(null===e||void 0===e?void 0:e.title)}else u(Fe[0].title)}),[n]);var b=i.a.useCallback((function(e){return e===Fe[0].path?t.map((function(e,t){return Object(B.jsx)(f.a.Item,{onClick:function(){a.push("".concat(Fe[0].path,"?table=").concat(e.table_name))},children:e.table_name},e.table_name)})):[]}),[t]),j=i.a.useCallback((function(){return Fe.map((function(e){var t=b(e.path);return e.hasSubMenu?Object(B.jsx)(Ye.a,{title:e.title,onTitleClick:function(){return a.push(e.path)},icon:e.icon,children:t},e.title):Object(B.jsx)(f.a.Item,{icon:e.icon,onClick:function(){return a.push(e.path)},children:e.title},e.title)}))}),[t]);return Object(B.jsx)(f.a,{theme:"light",mode:"inline",selectedKeys:void 0===d?[s]:[d],style:{height:"100%"},children:j()})}u.a.Header;var Ve=u.a.Sider,Ge=u.a.Content;var We=function(){var e=i.a.useState(!1),t=Object(r.a)(e,2),n=t[0],a=t[1];return Object(B.jsx)("div",{style:{overflow:"hidden"},children:Object(B.jsx)(Oe,{children:Object(B.jsx)(pe,{children:Object(B.jsx)(z,{children:Object(B.jsx)(s.a,{children:Object(B.jsxs)(u.a,{style:{height:"100vh",overflow:"hidden"},children:[Object(B.jsx)(d.a,{style:{margin:0,padding:0},bodyStyle:{padding:0},children:Object(B.jsxs)(b.a,{align:"middle",children:[Object(B.jsx)("div",{className:"trigger",onClick:function(){return a(!n)},children:n?Object(B.jsx)(j.a,{}):Object(B.jsx)(h.a,{})}),Object(B.jsx)("h1",{style:{padding:10},children:"CodeGen"}),Object(B.jsx)("div",{style:{flexGrow:1},children:" "}),Object(B.jsx)(l.c,{children:Fe.map((function(e,t){return Object(B.jsx)(l.a,{path:e.path,exact:!0,children:e.action},"route-action-".concat(t))}))})]})}),Object(B.jsxs)(u.a,{style:{background:"white"},children:[Object(B.jsx)(Ve,{collapsible:!0,style:{background:"#fff"},trigger:null,collapsed:n,children:Object(B.jsx)(He,{expanded:!n})}),Object(B.jsx)(Ge,{style:{margin:"0px 0px",padding:0,minHeight:280},children:Object(B.jsx)(l.c,{children:Fe.map((function(e,t){return Object(B.jsx)(l.a,{path:e.path,exact:!0,children:e.component},"route-".concat(t))}))})})]})]})})})})})})},$e=function(e){e&&e instanceof Function&&n.e(75).then(n.bind(null,985)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),i(e),c(e),o(e)}))};o.a.render(Object(B.jsx)(i.a.StrictMode,{children:Object(B.jsx)(We,{})}),document.getElementById("root")),$e()}},[[842,3,4]]]);
//# sourceMappingURL=main.3156ca6f.chunk.js.map